/* =========================
   Global + Background
   ========================= */
html, body { min-height: 100%; }

body {
    /* If the file is in /public, reference it as /background.svg */
    background-image: url('/public/background.svg');
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center top;
    background-attachment: fixed; /* desktop only; disabled on mobile below */
}

/* Avoid fixed backgrounds on mobile (prevents iOS/Android jank) */
@media (max-width: 768px) {
    html, body { min-height: 100svh; }
    body {
        background-attachment: scroll;
        background-position: center top;
    }
}

/* Soft overlay for readability over the background */
body::before {
    content: "";
    position: fixed;
    inset: 0;
    pointer-events: none;
    background: linear-gradient(to bottom, rgba(255,255,255,0.92), rgba(255,255,255,0.92));
    z-index: -1;
}
@media (prefers-color-scheme: dark) {
    body::before { background: linear-gradient(to bottom, rgba(0,0,0,0.6), rgba(0,0,0,0.6)); }
}

/* =========================
   Brand palette / theme vars
   ========================= */
:root {
    --brand-brown:  #8B5E34;
    --brand-green:  #2E7D32;
    --brand-purple: #6A1B9A;

    /* Map Starlight accents to your brand */
    --sl-color-accent: var(--brand-brown);
    --sl-color-accent-high: color-mix(in oklab, var(--brand-brown) 85%, black);
    --sl-color-text-accent: var(--brand-brown);
}
@media (prefers-color-scheme: dark) {
    :root {
        --sl-color-accent: color-mix(in oklab, var(--brand-brown) 80%, white);
        --sl-color-accent-high: color-mix(in oklab, var(--brand-brown) 65%, white);
        --sl-color-text-accent: var(--sl-color-accent);
    }
}

/* =========================
   Header (mobile vs desktop)
   ========================= */
/* MOBILE: header scrolls away with content */
header.header,
header.header[role="banner"],
header.sl-nav {
    position: relative;
    top: auto;
    z-index: 10;
    background: transparent !important;
    box-shadow: none !important;
    backdrop-filter: none !important;
    min-height: 56px; /* ensure room for the logo */
}

/* DESKTOP: header fixed; content scrolls under it */
@media (min-width: 769px) {
    header.header,
    header.header[role="banner"],
    header.sl-nav {
        position: fixed;
        top: 0; left: 0; right: 0;
        z-index: 2000; /* above everything else */
        width: 100%;
    }

    :root { --header-h: 56px; }            /* adjust to your actual header height */
    main, .sl-container, .sl-content {      /* push page down under fixed header */
        padding-top: var(--header-h);
    }
}

/* Center the site title / logo block */
header .sl-site-title.brand {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%,-50%);
    margin: 0;
    z-index: 1500;
    display: inline-flex;
    align-items: center;
    gap: .5rem;
    text-decoration: none;
}
header .sl-site-title.brand img {
    height: 40px; /* tweak as desired */
    width: auto;
    display: block;
}
@media (max-width: 480px) {
    header .sl-site-title.brand img { height: 32px; }
}

/* Header title link color (if shown as text anywhere) */
a.site-title,
a.site-title:visited,
a.site-title:active { color: #000 !important; text-decoration: none; }

/* =========================
   Hide mobile hamburger + drawer
   ========================= */
header button[aria-label="Menu"],
button[aria-controls="starlight__sidebar"],
button[aria-label="Open menu"],
button[aria-label="Close menu"],
.sl-nav-toggle,
summary.sl-nav-toggle {
    display: none !important;
}
/* Also ensure the mobile drawer cannot appear */
.sl-mobile-nav { display: none !important; }

/* =========================
   Sidebar (desktop)
   ========================= */
.sidebar-pane {
    background: transparent !important;
    border-right: 0 !important;
    box-shadow: none !important;
    backdrop-filter: none !important;
}
.sidebar-pane .sidebar-content,
.sidebar-pane .group {
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
}

/* Active/hover states in sidebar */
.sidebar-pane a[aria-current="page"] {
    color: var(--brand-brown) !important;
    background: color-mix(in oklab, var(--brand-brown) 12%, transparent) !important;
    border-left: 3px solid var(--brand-brown);
}
.sidebar-pane a:hover { color: var(--brand-green); }
.sidebar-pane a:focus-visible {
    outline: 2px solid var(--brand-purple);
    outline-offset: 2px;
}

/* =========================
   Content layout + typography
   ========================= */
.sl-container { padding-inline: 1rem; }
@media (min-width: 769px) { .sl-container { padding-inline: 2rem; } }

.sl-content { background: transparent !important; }

/* Headings a bit smaller on very small phones */
@media (max-width: 480px) {
    .sl-content h1 { font-size: 1.6rem; }
    .sl-content h2 { font-size: 1.3rem; }
    .sl-content h3 { font-size: 1.15rem; }
}

/* Media & code responsiveness */
img, video, svg { max-width: 100%; height: auto; }
pre, code { overflow-x: auto; word-wrap: normal; }

/* Ensure page content sits under header in stacking order */
main, .sl-container, .sl-content {
    position: relative;
    z-index: 1; /* lower than header (2000) on desktop */
}

/* =========================
   Ingredients index chips
   ========================= */
.ingredients-index {
    display: grid;
    grid-template-columns: 1fr;   /* single column by default */
    gap: 0.5rem;
    margin: 0.75rem 0 1rem;
}
@media (min-width: 480px) {
    .ingredients-index { grid-template-columns: 1fr 1fr; }
}
.ingredients-index .chip {
    display: block;
    padding: 0.45rem 0.75rem;
    border-radius: 0.6rem;
    border: 1px solid rgba(0,0,0,0.12);
    text-decoration: none;
    font-weight: 600;
    background: rgba(255,255,255,0.85);
    color: var(--sl-color-text);
}
.ingredients-index .chip:hover {
    color: var(--brand-brown);
    border-color: rgba(0,0,0,0.2);
}

/*FIXING LOGO*/
/* --- Logo + header sizing variables --- */
:root {
    --logo-h-mobile: 56px;   /* was 40px — raise for phones */
    --logo-h-desktop: 80px;  /* your requested size */
    --header-h-mobile: 68px; /* >= logo height with some breathing room */
    --header-h-desktop: 96px;/* >= desktop logo height */
}

/* Header is the positioning context for the centered logo */
header.header,
header.header[role="banner"],
header.sl-nav {
    position: relative;
    min-height: var(--header-h-mobile);
    overflow: visible;            /* don’t clip taller logo */
}

/* Centered logo block */
header .sl-site-title.brand {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%,-50%);
    margin: 0;
    z-index: 1500;
    display: inline-flex;
    align-items: center;
    gap: .5rem;
    text-decoration: none;
}

/* Logo sizing */
header .sl-site-title.brand img {
    height: var(--logo-h-mobile);
    width: auto;
    display: block;
}

/* Desktop: fixed header + matching content offset */
@media (min-width: 769px) {
    header.header,
    header.header[role="banner"],
    header.sl-nav {
        position: fixed;
        top: 0; left: 0; right: 0;
        z-index: 2000;
        min-height: var(--header-h-desktop);
    }

    /* push content below the taller fixed header */
    main, .sl-container, .sl-content {
        padding-top: calc(var(--header-h-desktop) - 80px);
    }

    /* bigger logo on desktop */
    header .sl-site-title.brand img {
        height: var(--logo-h-desktop);
    }
}

/* Tighten the very first heading on a page */
.sl-content > :is(h1,h2):first-child {
    margin-top: 0.25rem;  /* was ~1–2rem by default */
}

/* If your pages start with MDX content blocks, also normalize */
.sl-content > :first-child {
    margin-top: 0.25rem;
}

/* ===== Desktop: header fixed OVER content (content scrolls UNDER) ===== */
@media (min-width: 769px) {
    :root {
        --header-h-desktop: 96px;      /* adjust to your actual header height */
        --z-header: 999999;            /* very high to beat any rogue elements */
    }

    /* Make header fixed and in its own stacking context */
    header.header,
    header.header[role="banner"],
    header.sl-nav {
        position: fixed;
        top: 0; left: 0; right: 0;
        width: 100%;
        z-index: var(--z-header);
        isolation: isolate;            /* creates a new stacking context for safety */
        background: transparent !important;
        box-shadow: none !important;
        min-height: var(--header-h-desktop);
        overflow: visible;             /* don’t clip a tall logo */
    }

    /* Only offset ONCE: push main content down under the fixed header */
    main {
        padding-top: var(--header-h-desktop);
    }

    /* Ensure content can’t rise above the header */
    main, .sl-container, .sl-content {
        position: relative;
        z-index: 1;                    /* lower than header */
    }

    /* If any element still overlaps, it likely has an explicit high z-index.
       Nudge common offenders down without breaking layout: */
    .sl-content *[style*="z-index"],
    .sl-content [class*="sticky"],
    .sl-content pre, .sl-content code {
        z-index: 1 !important;
    }
}

/* =========================
   MOBILE header sizing & top gap
   ========================= */
@media (max-width: 768px) {
    :root{
        /* Tune these two to change header + logo size on phones */
        --header-h-mobile: 82px;   /* overall header height */
        --logo-h-mobile:   66px;   /* logo image height */

        /* Extra space between header and first row of content */
        --mobile-top-gap:  6px;    /* increase/decrease to taste */
    }

    /* Header block (mobile scrolls away with content) */
    header.header,
    header.header[role="banner"],
    header.sl-nav {
        position: relative;             /* not fixed on mobile */
        min-height: var(--header-h-mobile);
        background: transparent !important;
        box-shadow: none !important;
        overflow: visible;              /* prevent logo clipping */
    }

    /* Centered logo size on mobile */
    header .sl-site-title.brand img {
        height: var(--logo-h-mobile);
        width: auto;
    }

    /* Make sure no desktop offset bleeds into mobile */
    main { padding-top: 0; }

    /* Tighten the first element/heading at the top of the page */
    .sl-content > :first-child { margin-top: var(--mobile-top-gap); }
    .sl-content > :is(h1,h2):first-child { margin-top: var(--mobile-top-gap); }
}

/* Mobile: control the gap between header and first row */
@media (max-width: 768px) {
    .main-frame { padding-top: 8px; } /* tweak to taste */
}

/* Desktop: avoid double-offset if you’re already padding <main> */
@media (min-width: 769px) {
    .main-frame { padding-top: 0; }
}

/*FIXING DESKTOP NOW*/
/* =========================
   Desktop offsets (header, main, sidebar)
   ========================= */
@media (min-width: 769px) {
    /* 1) Make sure this matches your actual fixed header height */
    :root {
        --header-h-desktop: 96px;     /* tweak to your header/logo size */
        --desktop-gap: -30px;           /* extra breathing room if you want */
    }

    /* 2) Only offset the page ONCE: push main below the fixed header */
    main {
        padding-top: calc(var(--header-h-desktop) + var(--desktop-gap)) !important;
    }

    /* Remove any other top offsets that might double-pad the page */
    .sl-container,
    .sl-content,
    .main-frame { padding-top: 10px !important; }

    /* 3) Start the sidebar below the header */
    /* If your build uses the aside+classes below, these catch them all */
    aside[aria-label="Sidebar"],
    .starlight__sidebar,
    .sidebar-pane {
        /* If your sidebar is in normal flow (most Starlight setups): */
        margin-top: calc(var(--header-h-desktop) + var(--desktop-gap));
    }

    /* If your sidebar is sticky, set its sticky top to the header height.
       (Safe to keep even if it isn't sticky; it only applies when sticky.) */
    .starlight__sidebar,
    .sidebar-pane {
        top: calc(var(--header-h-desktop) + var(--desktop-gap));
    }

    /* Optional: tell Starlight's own layout vars your header height */
    :root { --sl-nav-height: var(--header-h-desktop); }
}

/* Only hide the H1 when the page includes the data-hide-title marker */
main:has(> .sl-container .sl-content > [data-hide-title]) .sl-content > h1:first-child {
    display: none !important;
}

/* Tighten spacing when hidden */
main:has(> .sl-container .sl-content > [data-hide-title]) .sl-content > :first-child {
    margin-top: 0.25rem;
}


/*SOLID HEADER*/
/* Desktop: make the fixed header opaque so content is hidden underneath */
@media (min-width: 769px) {
    header.header,
    header.header[role="banner"],
    header.sl-nav {
        background: rgba(255, 255, 255, 0.98) !important; /* solid/light bg */
        backdrop-filter: blur(6px);                        /* optional: frosted look */
        -webkit-backdrop-filter: blur(6px);
        isolation: isolate;                                /* keep it on top */
        z-index: 999999;                                   /* ensure top layer */
    }

    /* Dark mode variant */
    @media (prefers-color-scheme: dark) {
        header.header,
        header.header[role="banner"],
        header.sl-nav {
            background: rgba(16, 16, 16, 0.98) !important;
        }
    }
}

/* ============ Mobile: center the hamburger inside <nav.sidebar> ============ */
@media (max-width: 768px) {
    :root {
        /* set these once so nav + header are the same height */
        --header-h-mobile: 0px;   /* adjust to your design */
        --hamburger-right: 12px;    /* distance from left edge */
    }

    /* Make nav a positioning context & match header height */
    nav.sidebar {
        position: relative;
        min-height: var(--header-h-mobile);
    }

    /* Vertically center the button within nav */
    nav.sidebar starlight-menu-button > button[aria-label="Menu"][aria-controls="starlight__sidebar"] {
        position: absolute !important;
        right: var(--hamburger-right);
        top: 50%;
        transform: translateY(-50%);
        height: 44px; width: 44px;                 /* comfy tap target */
        display: inline-flex !important;
        align-items: center; justify-content: center;
        margin: 0; padding: 0;
        z-index: 1600;
    }

    /* Keep the SVGs centered in the button */
    nav.sidebar starlight-menu-button > button svg { display: block; }
}

/* =========================
   Keep hamburger hidden on DESKTOP
   ========================= */
@media (min-width: 769px) {
    header button[aria-label="Menu"],
    button[aria-controls="starlight__sidebar"],
    .sl-nav-toggle,
    summary.sl-nav-toggle,
    .sl-mobile-nav {
        display: none !important;
    }
}


/* Show only the correct icon on the mobile menu button */
@media (max-width: 768px) {
    /* default (menu closed) → show hamburger, hide X */
    nav.sidebar starlight-menu-button > button .open-menu { display: inline-block; }
    nav.sidebar starlight-menu-button > button .close-menu { display: none; }

    /* when menu is open (aria-expanded=true) → show X, hide hamburger */
    nav.sidebar starlight-menu-button > button[aria-expanded="true"] .open-menu { display: none; }
    nav.sidebar starlight-menu-button > button[aria-expanded="true"] .close-menu { display: inline-block; }

    /* optional: consistent sizing & touch target */
    nav.sidebar starlight-menu-button > button svg { width: 24px; height: 24px; }
    nav.sidebar starlight-menu-button > button {
        color: currentColor;           /* inherits header/nav color */
        background: transparent;
        border: 0;
    }
}


/* =========================
   MOBILE: keep header & nav same height + center logo
   ========================= */
@media (max-width: 768px) {
    :root{
        --header-h-mobile: 82px;   /* ← make this tall enough for your logo */
        --logo-h-mobile:   64px;   /* logo image height on phones */
        --hamburger-h-mobile: -150px;
    }

    /* Header row sizing + no clipping */
    header.header,
    header.header[role="banner"],
    header.sl-nav {
        position: relative;
        min-height: var(--header-h-mobile);
        overflow: visible;               /* prevent top/bottom clipping */
    }

    /* Center the logo block vertically in the header */
    header .sl-site-title.brand {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%,-50%);
        margin: 0;
    }

    /* Logo size */
    header .sl-site-title.brand img {
        height: var(--logo-h-mobile);
        width: auto;
        display: block;
    }

    /* Make the <nav class="sidebar"> row match the header height */
    nav.sidebar {
        position: relative;
        min-height: var(--header-h-mobile);
    }

    /* Your hamburger centering can stay; just ensure it stays within this height */
    nav.sidebar starlight-menu-button > button[aria-label="Menu"][aria-controls="starlight__sidebar"] {
        height: 44px; width: 44px; /* comfy tap target within the header height */
        top: -40px;
    }
}
